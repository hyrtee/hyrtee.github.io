<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>9pfs on Hyrtee's Blog</title><link>https://hyrtee.github.io/tags/9pfs/</link><description>Recent content in 9pfs on Hyrtee's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 24 Jun 2023 18:25:36 +0800</lastBuildDate><atom:link href="https://hyrtee.github.io/tags/9pfs/index.xml" rel="self" type="application/rss+xml"/><item><title>qemu使用9pfs共享宿主机文件</title><link>https://hyrtee.github.io/2023/qemu-9pfs/</link><pubDate>Sat, 24 Jun 2023 18:25:36 +0800</pubDate><guid>https://hyrtee.github.io/2023/qemu-9pfs/</guid><description>&lt;h2 id="预置条件">预置条件&lt;/h2>
&lt;p>kernel开启相关配置项：&lt;/p>
&lt;pre>&lt;code class="language-bash">CONFIG_9P_FS=y
CONFIG_9P_FS_POSIX_ACL=y
CONFIG_9P_FS_SECURITY=y
CONFIG_NETWORK_FILESYSTEMS=y
CONFIG_NET_9P=y
CONFIG_NET_9P_DEBUG=y
CONFIG_NET_9P_VIRTIO=y
CONFIG_PCI=y
CONFIG_PCI_HOST_COMMON=y
CONFIG_PCI_HOST_GENERIC=y
CONFIG_VIRTIO_PCI=y
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_NET=y
CONFIG_VIRTIO_MMIO=y
CONFIG_FUSE_FS=y
CONFIG_VIRTIO_FS=y
CONFIG_VIRTIO_INPUT=y
&lt;/code>&lt;/pre>
&lt;p>宿主机支持相关库&lt;/p>
&lt;pre>&lt;code class="language-bash">sudo apt install -y libcap-dev
sudo apt install -y libattr
sudo apt install -y libattr-dev
&lt;/code>&lt;/pre>
&lt;p>qemu编译支持virtfs&lt;/p>
&lt;pre>&lt;code class="language-bash">./configure --target-list=aarch64-softmmu --enable-kvm --enable-virtfs --enable-slirp --enable-debug
&lt;/code>&lt;/pre>
&lt;h2 id="执行步骤">执行步骤&lt;/h2>
&lt;p>path/to/share：设置成自己在宿主机的要共享的目录&lt;/p>
&lt;pre>&lt;code class="language-bash">qemu-system-aarch64 \
-M virt,secure=on -m 4G -nographic \
-machine firmware=bl31.bin \
-fsdev local,id=shareid,path=/path/to/share,security_model=none \
-device virtio-9p-device,fsdev=shareid,mount_tag=share \
-device loader,addr=0x1002000000,file=tee.elf \
--kernel Image \
--initrd rootfs.cpio.gz
&lt;/code>&lt;/pre></description></item></channel></rss>