<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hyrtee's Blog</title><link>https://hyrtee.github.io/</link><description>Recent content on Hyrtee's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Fri, 23 Jun 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://hyrtee.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Qemu通过9pfs实现宿主机文件共享</title><link>https://hyrtee.github.io/2023/qemu%E9%80%9A%E8%BF%879pfs%E5%AE%9E%E7%8E%B0%E5%AE%BF%E4%B8%BB%E6%9C%BA%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/</link><pubDate>Sun, 18 Jun 2023 03:52:25 +0800</pubDate><guid>https://hyrtee.github.io/2023/qemu%E9%80%9A%E8%BF%879pfs%E5%AE%9E%E7%8E%B0%E5%AE%BF%E4%B8%BB%E6%9C%BA%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/</guid><description>&lt;h2 id="预置条件">预置条件&lt;/h2>
&lt;p>kernel开启相关配置项：&lt;/p>
&lt;pre>&lt;code class="language-bash">CONFIG_9P_FS=y
CONFIG_9P_FS_POSIX_ACL=y
CONFIG_9P_FS_SECURITY=y
CONFIG_NETWORK_FILESYSTEMS=y
CONFIG_NET_9P=y
CONFIG_NET_9P_DEBUG=y
CONFIG_NET_9P_VIRTIO=y
CONFIG_PCI=y
CONFIG_PCI_HOST_COMMON=y
CONFIG_PCI_HOST_GENERIC=y
CONFIG_VIRTIO_PCI=y
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_NET=y
CONFIG_VIRTIO_MMIO=y
CONFIG_FUSE_FS=y
CONFIG_VIRTIO_FS=y
CONFIG_VIRTIO_INPUT=y
&lt;/code>&lt;/pre>
&lt;p>宿主机支持相关库&lt;/p>
&lt;pre>&lt;code class="language-bash">sudo apt install -y libcap-dev
sudo apt install -y libattr
sudo apt install -y libattr-dev
&lt;/code>&lt;/pre>
&lt;p>qemu编译支持virtfs&lt;/p>
&lt;pre>&lt;code class="language-bash">./configure --target-list=aarch64-softmmu --enable-kvm --enable-virtfs --enable-slirp --enable-debug
&lt;/code>&lt;/pre>
&lt;h2 id="执行步骤">执行步骤&lt;/h2>
&lt;p>path/to/share：设置成自己在宿主机的要共享的目录&lt;/p>
&lt;pre>&lt;code class="language-bash">qemu-system-aarch64 \
-M virt,secure=on -m 4G -nographic \
-machine firmware=bl31.bin \
-fsdev local,id=shareid,path=/path/to/share,security_model=none \
-device virtio-9p-device,fsdev=shareid,mount_tag=share \
-device loader,addr=0x1002000000,file=tee.elf \
--kernel Image \
--initrd rootfs.cpio.gz
&lt;/code>&lt;/pre></description></item></channel></rss>